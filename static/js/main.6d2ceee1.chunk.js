(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{105:function(e,t,n){},107:function(e,t,n){},109:function(e,t,n){},119:function(e,t,n){"use strict";n.r(t);var r=n(8),a=n(0),o=n.n(a),s=n(43),c=n.n(s),i=n(11),l=n(42),u=n(2),m=n(58),d=n(52),p=n(53),h=n(126),g={INITIAL:"initial",LOADING:"loading",AUTHENTICATED:"authenticated"},E={GITHUB_TOKEN:"github_token"},f=n(54),y=n(55),v=n(59),N=n(56),w=n(60),I=n(57),O=n.n(I),b=n(13),T=n(12),A=n.n(T),C=n(21),S=n.n(C);n(93);A.a.extend(S.a);var j=function(e){var t=e.name,n=e.pushedAt,r=e.url,a=e.descriptionHTML;return o.a.createElement(o.a.Fragment,null,o.a.createElement("h3",null,o.a.createElement("a",{href:r},t)),o.a.createElement("div",{dangerouslySetInnerHTML:{__html:a}}),o.a.createElement("p",null,n&&o.a.createElement("span",null,"Updated ",o.a.createElement("span",{title:n},A()(n).fromNow()))))},k=n(18);A.a.extend(S.a);var L=function(e){var t=e.issue;return o.a.createElement("li",{className:"IssueItem"},o.a.createElement("h5",null,o.a.createElement("a",{href:t.url},t.title)),o.a.createElement("p",null,t.author&&o.a.createElement("span",null,"Opened by ",o.a.createElement("a",{href:t.author.url},t.author.login)),t.createdAt&&o.a.createElement("span",{title:t.createdAt}," ",A()(t.createdAt).fromNow())))},M=function(){return o.a.createElement("ol",{className:"RepositoryList"},Array(10).fill("").map(function(e,t){return o.a.createElement("li",{key:t,className:"RepositoryItem RepositoryItem-placeholder"},o.a.createElement("div",{className:"RepositoryItem-placeholder-name"}),o.a.createElement("div",{className:"RepositoryItem-placeholder-text"}),o.a.createElement("div",{className:"RepositoryItem-placeholder-text"}))}))},H=function(e){var t=e.loading,n=e.hasNextPage,r=e.variables,a=e.updateQuery,s=e.fetchMore,c=e.children;return o.a.createElement("div",{className:"FetchMore"},t?o.a.createElement(M,null):o.a.createElement("button",{className:"btn btn-outline btn-block",disabled:!n,onClick:function(){return s({variables:r,updateQuery:a})}},"More ",c))},R=function(e){var t=e.error;return o.a.createElement("div",{className:"ErrorMessage"},o.a.createElement("small",null,t.toString()))},P=n(15),x=n(16),D=n.n(x);function $(){var e=Object(P.a)(["\n  query($repositoryOwner: String!, $repositoryName: String!, $cursor: String) {\n    repository(name: $repositoryName, owner: $repositoryOwner) {\n      pullRequests(\n        first: 5\n        states: [OPEN]\n        after: $cursor\n        orderBy: { field: CREATED_AT, direction: DESC }\n      ) {\n        edges {\n          node {\n            id\n            title\n            createdAt\n            url\n            bodyHTML\n            author {\n              login\n              url\n            }\n          }\n        }\n        pageInfo {\n          endCursor\n          hasNextPage\n        }\n      }\n    }\n  }\n"]);return $=function(){return e},e}function _(){var e=Object(P.a)(["\n  query($repositoryOwner: String!, $repositoryName: String!, $cursor: String) {\n    repository(name: $repositoryName, owner: $repositoryOwner) {\n      issues(\n        first: 5\n        states: [OPEN]\n        after: $cursor\n        orderBy: { field: CREATED_AT, direction: DESC }\n      ) {\n        edges {\n          node {\n            id\n            title\n            createdAt\n            url\n            bodyHTML\n            author {\n              login\n              url\n            }\n          }\n        }\n        pageInfo {\n          endCursor\n          hasNextPage\n        }\n      }\n    }\n  }\n"]);return _=function(){return e},e}var U=D()(_()),q=D()($()),B=(n(105),function(e){return function(t,n){var a=n.fetchMoreResult;return a?Object(r.a)({},t,{repository:Object(r.a)({},t.repository,Object(k.a)({},e,Object(r.a)({},t.repository[e],a.repository[e],{edges:Object(b.a)(t.repository[e].edges).concat(Object(b.a)(a.repository[e].edges))})))}):t}}),G=function(e){var t=e.issues,n=e.loading,r=e.repositoryOwner,a=e.repositoryName,s=e.fetchMore,c=e.entry;return o.a.createElement(o.a.Fragment,null,o.a.createElement("ol",{className:"IssueList"},t.edges.map(function(e){var t=e.node;return o.a.createElement(L,{key:t.id,issue:t,repositoryOwner:r,repositoryName:a})})),o.a.createElement(H,{loading:n,hasNextPage:t.pageInfo.hasNextPage,variables:{cursor:t.pageInfo.endCursor,repositoryOwner:r,repositoryName:a},updateQuery:B(c),fetchMore:s}))},Q=function(e){var t=e.repositoryOwner,n=e.repositoryName,r=e.entry;return o.a.createElement("div",{className:"Issues"},o.a.createElement(i.Query,{query:"issues"===r?U:q,variables:{repositoryOwner:t,repositoryName:n},notifyOnNetworkStatusChange:!0},function(e){var a=e.data,s=e.loading,c=e.error,i=e.fetchMore;if(c)return o.a.createElement(R,{error:c});var l=a.repository;return s&&!l?o.a.createElement(M,null):l[r].edges.length?o.a.createElement(G,{issues:l[r],loading:s,repositoryOwner:t,repositoryName:n,fetchMore:i,entry:r}):o.a.createElement("div",{className:"IssueList"},"No issues found.")}))},K=(n(107),function(e,t){var n=t.fetchMoreResult;return n?Object(r.a)({},e,{viewer:Object(r.a)({},e.viewer,{watching:Object(r.a)({},e.viewer.watching,n.viewer.watching,{edges:Object(b.a)(e.viewer.watching.edges).concat(Object(b.a)(n.viewer.watching.edges))})})}):e}),F=function(e){var t=e.loading,n=e.repositories,r=e.fetchMore;return o.a.createElement(o.a.Fragment,null,o.a.createElement("ol",{className:"RepositoryList"},n.edges.map(function(e){var t=e.node;return o.a.createElement("li",{key:t.id,className:"RepositoryItem"},o.a.createElement(j,t),o.a.createElement("details",null,o.a.createElement("summary",null,"Issues (",t.issues.totalCount,")"),o.a.createElement(Q,{entry:"issues",repositoryName:t.name,repositoryOwner:t.owner.login})),o.a.createElement("details",null,o.a.createElement("summary",null,"Pull Requests (",t.pullRequests.totalCount,")"),o.a.createElement(Q,{entry:"pullRequests",repositoryName:t.name,repositoryOwner:t.owner.login})))})),o.a.createElement(H,{loading:t,hasNextPage:n.pageInfo.hasNextPage,variables:{cursor:n.pageInfo.endCursor},updateQuery:K,fetchMore:r}))};function z(){var e=Object(P.a)(["\n  query($cursor: String) {\n    viewer {\n      watching(\n        first: 10\n        after: $cursor\n        orderBy: { field: PUSHED_AT, direction: DESC }\n      ) {\n        edges {\n          node {\n            id\n            name\n            pushedAt\n            url\n            descriptionHTML\n            owner {\n              login\n              url\n            }\n            issues(states: [OPEN]) {\n              totalCount\n            }\n            pullRequests(states: [OPEN]) {\n              totalCount\n            }\n          }\n        }\n        pageInfo {\n          endCursor\n          hasNextPage\n        }\n      }\n    }\n  }\n"]);return z=function(){return e},e}var J=D()(z()),V=function(){return o.a.createElement(i.Query,{query:J,notifyOnNetworkStatusChange:!0},function(e){var t=e.data,n=e.loading,r=e.error,a=e.fetchMore;return r?o.a.createElement(R,{error:r}):n&&!t.viewer?o.a.createElement(M,null):o.a.createElement(F,{loading:n,repositories:t.viewer.watching,fetchMore:a})})},W=(n(109),function(e){function t(){var e,n;Object(f.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(v.a)(this,(e=Object(N.a)(t)).call.apply(e,[this].concat(a)))).state={status:g.INITIAL},n.logout=function(){window.localStorage.removeItem(E.GITHUB_TOKEN),n.setState({token:null,status:g.INITIAL})},n}return Object(w.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){var e=this;if(window.localStorage.getItem(E.GITHUB_TOKEN))this.setState({status:g.AUTHENTICATED});else{var t=window.location.href.match(/\?code=(.*)/)&&window.location.href.match(/\?code=(.*)/)[1];t&&this.setState({status:g.LOADING},function(){return e.authenticate(t)})}}},{key:"authenticate",value:function(e){var t=this;O.a.get("".concat("https://gitobserve.herokuapp.com/authenticate","/").concat(e)).then(function(e){var n=e.data.token;n&&(window.localStorage.setItem(E.GITHUB_TOKEN,n),t.setState({token:n,status:g.AUTHENTICATED}))}).catch(function(e){return console.error("Error while authenticating: ".concat(e))})}},{key:"render",value:function(){var e=this.state.status;return o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"Header"},o.a.createElement("div",{className:"Logo"},o.a.createElement("a",{href:"/"},"GitObserve")),o.a.createElement("div",null,e===g.INITIAL&&o.a.createElement("a",{className:"text-white",href:"".concat("https://github.com/login/oauth/authorize","?client_id=").concat("b6158c6cdfd4de1993f6","&scope=user%20repo%20read%3Aorg&redirect_uri=").concat("https://apaunchev.github.io/gitobserve")},"Login"),e===g.AUTHENTICATED&&o.a.createElement("button",{className:"btn-link text-white",onClick:this.logout},"Logout"))),o.a.createElement("div",{className:"Main"},e===g.LOADING&&o.a.createElement(M,null),e===g.AUTHENTICATED&&o.a.createElement(V,null)))}}]),t}(a.Component)),X=(n(111),new m.a({uri:"https://api.github.com/graphql"})),Y=Object(d.a)(function(e,t){var n=t.headers,a=window.localStorage.getItem(E.GITHUB_TOKEN);return{headers:Object(r.a)({},n,{authorization:a?"Bearer ".concat(a):""})}}),Z=Object(p.a)(function(e){var t=e.graphQLErrors,n=e.networkError;t&&t.map(function(e){var t=e.message,n=e.locations,r=e.path;return console.log("[GraphQL error]: Message: ".concat(t,", Location: ").concat(n,", Path: ").concat(r))}),n&&console.log("[Network error]: ".concat(n))}),ee=u.a.from([Z,Y,X]),te=new h.a,ne=new l.a({link:ee,cache:te});c.a.render(o.a.createElement(i.ApolloProvider,{client:ne},o.a.createElement(W,null)),document.getElementById("root"))},61:function(e,t,n){e.exports=n(119)},93:function(e,t,n){}},[[61,2,1]]]);
//# sourceMappingURL=main.6d2ceee1.chunk.js.map