(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{34:function(e,t,a){e.exports=a(51)},51:function(e,t,a){"use strict";a.r(t);var n,r=a(15),l=a.n(r),c=a(0),o=a.n(c),s=a(31),i=a(10),u=a(56),m=a(52),d=a(46),p=a(59),E=a(6),h=a(24),g=a(16),b=a(17),f=a(20),v=a(18),y=a(21),N=a(4),R=a(9),k=a.n(R),S=a(19),O=function(){var e=Object(S.a)(k.a.mark(function e(t,a){var n,r;return k.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.github.com/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({query:t})});case 2:if(!(n=e.sent).ok){e.next=11;break}return e.next=6,n.json();case 6:if(!(r=e.sent).errors){e.next=9;break}throw new Error(r.errors[0].message);case 9:if(!r.data){e.next=11;break}return e.abrupt("return",r.data);case 11:throw new Error("Error communicating with GitHub");case 12:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}(),x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e?"after: ".concat(e):"";return"\n      query {\n        viewer {\n          watching(\n            first: 100\n            ".concat(t,"\n          ) {\n            edges {\n              cursor\n              node {\n                id\n                name\n                url\n                owner {\n                  login\n                  avatarUrl\n                }\n                createdAt\n              }\n            }\n            totalCount\n            pageInfo {\n              hasNextPage\n            }\n          }\n        }\n      }\n    ")},w=function(e){return"\n    query {\n      nodes (ids: ".concat(JSON.stringify(e),") {\n        id\n        ... on Repository {\n          pullRequests(\n            last: 50\n            states: [OPEN]\n            orderBy: { field: CREATED_AT, direction: DESC }\n          ) {\n            edges {\n              node {\n                id\n                number\n                title\n                url\n                createdAt\n                updatedAt\n                repository {\n                  nameWithOwner\n                  url\n                }\n                author {\n                  avatarUrl\n                  login\n                  url\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  ")},_=function(e,t){return{type:"REQUEST_PULL_REQUESTS_SUCCESS",data:e,watchedRepos:t}},j=a(57),T=a(55),A="bg-green",C="bg-blue",U="bg-purple",L=function(e){var t=Object(j.a)(new Date(e),new Date);return t>-7?A:t<=-7&&t>=-28?C:t<-28?U:null},P=function(e){var t=e.number,a=e.title,n=e.url,r=e.createdAt,l=e.updatedAt,c=e.author,s=e.repository,i=new Date;return o.a.createElement("div",{className:"Box-row Box-row--hover-gray d-flex"},c.avatarUrl&&o.a.createElement("div",{className:"pr-3"},o.a.createElement("img",{className:"avatar",src:c.avatarUrl,width:"48",height:"48",alt:""})),o.a.createElement("div",{className:"flex-auto pr-3"},o.a.createElement("a",{href:s.url,className:"muted-link h4 pr-1"},s.nameWithOwner),o.a.createElement("a",{href:n,className:"link-gray-dark no-underline h4"},a),o.a.createElement("div",{className:"text-gray"},"#",t," opened"," ",o.a.createElement("span",{title:r},Object(T.a)(r,i)," ago")," by"," ",o.a.createElement("a",{href:c.url,className:"muted-link"},c.login))),o.a.createElement("div",{className:"d-flex flex-items-center"},o.a.createElement("span",{className:"d-inline-block px-3 py-1 rounded-1 text-white no-wrap tooltipped tooltipped-s ".concat(L(l)),"aria-label":"Last updated ".concat(Object(T.a)(l,i)," ago")},Object(T.a)(l,i)," ago")))},B=function(e){function t(){var e,a;Object(g.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(f.a)(this,(e=Object(v.a)(t)).call.apply(e,[this].concat(r)))).state={orderByField:"updatedAt",sortByRepo:!1,filterByAuthor:""},a.handleInputChange=function(e){var t=e.target,n="checkbox"===t.type?t.checked:t.value,r=t.name;a.setState(Object(h.a)({},r,n))},a}return Object(y.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.props.selectedRepos.length>0&&this.props.requestPullRequests(this.props.selectedRepos,this.props.token)}},{key:"render",value:function(){var e=this.state,t=e.orderByField,a=e.sortByRepo,n=e.filterByAuthor,r=this.props,c=r.selectedRepos,s=r.pullRequests,i=r.loading,u=r.githubError,m=r.requestPullRequests,p=r.token,h=[],g=[t],b=["desc"],f=[];return s.length>0&&(f=l.a.map(s,function(e){return Object(E.a)({},e,{repoName:e.repository.nameWithOwner})}),h=l.a.chain(f).map(function(e){return e.author}).uniqBy("login").value(),a&&(g.unshift("repoName"),b.unshift("asc")),t&&(f=l.a.orderBy(f,g,b)),n&&(f=l.a.filter(f,function(e){return e.author.login===n}))),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"App-menu p-3 bg-gray-light border-bottom"},o.a.createElement("div",{className:"container-lg d-flex flex-items-center"},o.a.createElement("div",{className:"flex-auto"},o.a.createElement("h1",{className:"h3"},"Dashboard")),o.a.createElement("div",null,o.a.createElement(d.a,{to:"/settings",className:"btn mr-2"},o.a.createElement(N.h,{icon:N.f})," Settings")))),o.a.createElement("main",{className:"App-main"},o.a.createElement("div",{className:"container-lg py-4"},o.a.createElement("div",{className:"Box"},o.a.createElement("div",{className:"Box-header d-flex flex-items-center"},o.a.createElement("div",{className:"flex-auto d-flex flex-items-center"},o.a.createElement("span",{className:"d-inline-flex flex-items-center mr-3 text-bold"},o.a.createElement(N.h,{icon:N.b,size:20,className:"pr-1"}),f.length," pull requests"),o.a.createElement("span",{className:"text-gray mr-2"},"Order by:"),o.a.createElement("select",{className:"form-select select-sm mr-2",name:"orderByField",value:this.state.orderByField,onChange:this.handleInputChange},o.a.createElement("option",{value:"updatedAt"},"recently updated"),o.a.createElement("option",{value:"createdAt"},"newest")),o.a.createElement("select",{className:"form-select select-sm mr-2",name:"filterByAuthor",value:this.state.filterByAuthor,onChange:this.handleInputChange},o.a.createElement("option",{value:""},"Select author"),h.map(function(e){var t=e.login;return o.a.createElement("option",{key:t,value:t},t)})),o.a.createElement("label",{className:"mr-2"},o.a.createElement("input",{type:"checkbox",name:"sortByRepo",value:a,onChange:this.handleInputChange})," ","Sort by repository")),o.a.createElement("div",null,o.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:function(){return m(c,p)}},o.a.createElement(N.h,{icon:N.g})," Sync"))),c.length?null:o.a.createElement("div",{className:"blankslate blankslate-clean-background"},o.a.createElement("p",null,"You have not selected any"," ",o.a.createElement(d.a,{to:"/settings/repositories"},"repositories")," yet.")),c.length>0&&i?o.a.createElement("div",{className:"blankslate blankslate-clean-background"},o.a.createElement("p",null,"Loading...")):null,c.length>0&&u?o.a.createElement("div",{className:"blankslate blankslate-clean-background"},o.a.createElement("p",null,"Error fetching data from GitHub. Ensure your"," ",o.a.createElement(d.a,{to:"/settings/account"},"token")," is set correctly and try again.")):null,c.length>0&&!i&&!u&&!f.length?o.a.createElement("div",{className:"blankslate blankslate-clean-background"},o.a.createElement("p",null,"No pull requests were found for your"," ",o.a.createElement(d.a,{to:"/settings"},"selected repositories"),".")):null,i||u||!f.length?null:f.map(function(e){return o.a.createElement(P,Object.assign({key:e.id},e))})))))}}]),t}(o.a.PureComponent),q=Object(i.b)(function(e){return{selectedRepos:e.settings.selectedRepos,githubError:e.dashboard.githubError,loading:e.dashboard.loading,pullRequests:e.dashboard.pullRequests,token:e.settings.token}},function(e){return{requestPullRequests:function(t,a){e(function(e,t){return function(){var a=Object(S.a)(k.a.mark(function a(n,r){var l,c,o;return k.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return l=r().watchedRepos.repos,a.prev=1,n({type:"REQUEST_PULL_REQUESTS_LOADING"}),c=w(e),a.next=6,O(c,t);case 6:o=a.sent,n(_(o,l)),a.next=13;break;case 10:a.prev=10,a.t0=a.catch(1),n({type:"REQUEST_PULL_REQUESTS_FAILURE",error:a.t0});case 13:case"end":return a.stop()}},a,this,[[1,10]])}));return function(e,t){return a.apply(this,arguments)}}()}(t,a))},dispatch:e}})(B),I=a(54),D=a(58),G=function(e){function t(e){var a;return Object(g.a)(this,t),(a=Object(f.a)(this,Object(v.a)(t).call(this,e))).input=o.a.createRef(),a}return Object(y.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.token,n=t.setToken;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"Subhead"},o.a.createElement("h2",{className:"Subhead-heading"},"Account")),o.a.createElement("p",null,"You need to add a Personal Access Token in order to access GitHub data."),o.a.createElement("ol",{className:"pl-3"},o.a.createElement("li",null,"Go to"," ",o.a.createElement("a",{href:"https://github.com/settings/tokens",target:"_blank",rel:"noopener noreferrer"},"Personal Access Tokens")," ","and click ",o.a.createElement("b",null,"Generate new token"),"."),o.a.createElement("li",null,"Enter a description, select the ",o.a.createElement("code",null,"repo")," scope, then click"," ",o.a.createElement("b",null,"Generate token"),"."),o.a.createElement("li",null,"Copy the given token and add it below.")),o.a.createElement("form",{className:"my-3"},o.a.createElement("input",{type:"text",className:"form-control",placeholder:"Token",ref:this.input,onChange:function(){return n(e.input.current.value)},value:a})))}}]),t}(c.Component),Q=Object(i.b)(function(e){return{token:e.settings.token}},function(e){return{setToken:function(t){return e(function(e){return{type:"SET_TOKEN",value:e}}(t))},dispatch:e}})(G),F=a(13),W=function(e){function t(){return Object(g.a)(this,t),Object(f.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.props.requestWatchedRepos(this.props.token)}},{key:"render",value:function(){var e=this.props,t=e.token,a=e.loading,n=e.githubError,r=e.watchedRepos,l=e.selectedRepos,c=e.selectAllRepos,s=e.resetSelectedRepos,i=e.toggleRepoSelection,u=e.requestWatchedRepos;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"Subhead"},o.a.createElement("h2",{className:"Subhead-heading"},"Repositories")),o.a.createElement("p",{className:"mb-4"},"Select the repositories you wish to monitor on the dashboard."," ",o.a.createElement("strong",null,"Only repositories you are"," ",o.a.createElement("a",{href:"https://github.com/watching"},"watching")," are listed here.")),o.a.createElement("div",{className:"Box"},o.a.createElement("div",{className:"Box-header py-2 d-flex flex-items-center"},o.a.createElement("h3",{className:"Box-title"},"Selected repositories"," ",o.a.createElement("span",{className:"Counter Counter--gray-dark"},l.length)),o.a.createElement("div",{className:"flex-auto text-right"},o.a.createElement("div",{className:"BtnGroup"},o.a.createElement("button",{className:"BtnGroup-item btn btn-sm",onClick:function(){return c(r.map(function(e){return e.id}))}},"Select all"),o.a.createElement("button",{className:"BtnGroup-item btn btn-sm",onClick:function(){return s()}},"Reset")),o.a.createElement("button",{className:"btn btn-sm btn-primary",onClick:function(){return u(t)}},o.a.createElement(N.h,{icon:N.g})," Sync"))),a?o.a.createElement("div",{className:"blankslate blankslate-clean-background"},o.a.createElement("p",null,"Loading...")):null,n?o.a.createElement("div",{className:"blankslate blankslate-clean-background"},o.a.createElement("p",null,"Error fetching data from GitHub. Ensure your"," ",o.a.createElement(d.a,{to:"/settings/account"},"token")," is set correctly and try again.")):null,a||n||r.length?null:o.a.createElement("div",{className:"blankslate blankslate-clean-background"},o.a.createElement("p",null,"You are not watching any repositories currently.")),!a&&!n&&r.length>0?r.map(function(e){var t=e.id,a=e.name,n=e.url,r="repo-".concat(t),c=l.includes(t);return o.a.createElement("div",{className:"Box-row Box-row--hover-gray d-flex flex-items-center py-2 px-3",key:t},o.a.createElement("div",{className:"form-checkbox flex-auto my-0"},o.a.createElement("label",null,o.a.createElement("input",{type:"checkbox",id:r,onChange:function(){return i(t)},checked:c})," ",a)),o.a.createElement("a",{className:"btn btn-sm btn-outline",href:n},o.a.createElement(N.h,{icon:N.c,size:14})," Open on GitHub"))}):null))}}]),t}(o.a.PureComponent),H=Object(i.b)(function(e){return{watchedRepos:e.watchedRepos.repos,loading:e.watchedRepos.loading,githubError:e.watchedRepos.githubError,selectedRepos:e.settings.selectedRepos,token:e.settings.token}},function(e){return{requestWatchedRepos:function(t){return e(function(e){return function(){var t=Object(S.a)(k.a.mark(function t(a){var n,r,l,c,o;return k.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a({type:"REQUEST_WATCHED_REPOS_LOADING"}),n=x(),t.next=5,O(n,e);case 5:if(r=t.sent,l=r.viewer.watching.edges,!r.viewer.watching.pageInfo.hasNextPage){t.next=18;break}c=!0;case 9:if(!c){t.next=18;break}return n=x(l[l.length-1].cursor),t.next=13,O(n,e);case 13:o=t.sent,l=[].concat(Object(F.a)(l),Object(F.a)(o.viewer.watching.edges)),c=o.viewer.watching.pageInfo.hasNextPage,t.next=9;break;case 18:l=l.map(function(e){return{id:e.node.id,name:e.node.name,url:e.node.url,owner:e.node.owner,createdAt:e.node.createdAt}}),a({type:"REQUEST_WATCHED_REPOS_SUCCESS",data:l}),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(0),a({type:"REQUEST_WATCHED_REPOS_FAILURE",error:t.t0});case 25:case"end":return t.stop()}},t,this,[[0,22]])}));return function(e){return t.apply(this,arguments)}}()}(t))},toggleRepoSelection:function(t){return e(function(e){return{type:"TOGGLE_REPO_SELECTION",id:e}}(t))},selectAllRepos:function(t){return e(function(e){return{type:"SELECT_ALL_REPOS",repoIds:e}}(t))},resetSelectedRepos:function(){return e({type:"RESET_SELECTED_REPOS"})},dispatch:e}})(W),J=function(e){var t=e.match;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"App-menu p-3 bg-gray-light border-bottom"},o.a.createElement("div",{className:"container-lg d-flex flex-items-center"},o.a.createElement("div",{className:"flex-auto"},o.a.createElement("h1",{className:"h3"},"Settings")),o.a.createElement("div",null,o.a.createElement(d.a,{to:"/",className:"btn btn-primary"},o.a.createElement(N.h,{icon:N.a})," Save")))),o.a.createElement("main",{className:"App-main"},o.a.createElement("div",{className:"container-lg py-4 d-flex"},o.a.createElement("div",{className:"col-3 pr-4"},o.a.createElement("nav",{className:"menu"},o.a.createElement(I.a,{to:"".concat(t.url,"/account"),className:"menu-item",activeClassName:"selected"},o.a.createElement(N.h,{icon:N.d})," Account"),o.a.createElement(I.a,{to:"".concat(t.url,"/repositories"),className:"menu-item",activeClassName:"selected"},o.a.createElement(N.h,{icon:N.e})," Repositories"))),o.a.createElement("div",{className:"col-9"},o.a.createElement(p.a,null,o.a.createElement(m.a,{exact:!0,path:"".concat(t.url),render:function(){return o.a.createElement(D.a,{to:"".concat(t.url,"/account")})}}),o.a.createElement(m.a,{path:"".concat(t.url,"/account"),component:Q}),o.a.createElement(m.a,{path:"".concat(t.url,"/repositories"),component:H}))))))},z=function(){return o.a.createElement("main",{className:"App-main"},o.a.createElement("div",{className:"container-lg py-4"},o.a.createElement("div",{className:"blankslate"},o.a.createElement("h3",null,"Not found"),o.a.createElement("p",null,"The page you are looking for could not be found."))))},Y=(a(48),function(){return o.a.createElement("div",{className:"App"},o.a.createElement("header",{className:"App-header p-3 bg-gray-dark text-white"},o.a.createElement("div",{className:"container-lg d-flex flex-items-center"},o.a.createElement("h1",{className:"flex-auto h2"},o.a.createElement(d.a,{to:"/",className:"text-white"},"GitObserve")))),o.a.createElement(p.a,null,o.a.createElement(m.a,{exact:!0,path:"/",component:q}),o.a.createElement(m.a,{path:"/settings",component:J}),o.a.createElement(m.a,{component:z})))}),K=function(e){var t=e.store;return o.a.createElement(i.a,{store:t},o.a.createElement(u.a,null,o.a.createElement(m.a,{path:"/",component:Y})))},M=a(14),V=(a(50),a(33)),X={pullRequests:[],loading:!1,githubError:null},Z={repos:[],loading:!1,githubError:null},$={token:null,selectedRepos:[]},ee=Object(M.c)({dashboard:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"REQUEST_PULL_REQUESTS_LOADING":return Object(E.a)({},t,{loading:!0,githubError:null});case"REQUEST_PULL_REQUESTS_SUCCESS":return n=a.data.nodes.filter(function(e){return e}).map(function(e){return e.pullRequests.edges.map(function(e){return e.node})}),n=(e=[]).concat.apply(e,Object(F.a)(n)),Object(E.a)({},t,{pullRequests:n,loading:!1,githubError:null});case"REQUEST_PULL_REQUESTS_FAILURE":return Object(E.a)({},t,{pullRequests:[],githubError:a.error,loading:!1});default:return t}},watchedRepos:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"REQUEST_WATCHED_REPOS_LOADING":return Object(E.a)({},e,{loading:!0,githubError:null});case"REQUEST_WATCHED_REPOS_SUCCESS":return Object(E.a)({},e,{repos:t.data,githubError:null,loading:!1});case"REQUEST_WATCHED_REPOS_FAILURE":return Object(E.a)({},e,{repos:[],githubError:t.error,loading:!1});default:return e}},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TOKEN":return Object(E.a)({},e,{token:t.value});case"TOGGLE_REPO_SELECTION":return e.selectedRepos.includes(t.id)?Object(E.a)({},e,{selectedRepos:e.selectedRepos.filter(function(e){return e!==t.id})}):Object(E.a)({},e,{selectedRepos:[].concat(Object(F.a)(e.selectedRepos),[t.id])});case"SELECT_ALL_REPOS":return Object(E.a)({},e,{selectedRepos:Object(F.a)(t.repoIds)});case"RESET_SELECTED_REPOS":return Object(E.a)({},e,{selectedRepos:[]});default:return e}}}),te=function(){var e=function(){try{var e=localStorage.getItem("go_state");if(null===e)return;return JSON.parse(e)}catch(t){return}}(),t=[V.a];return Object(M.d)(ee,e,M.a.apply(void 0,t))}();te.subscribe(Object(r.throttle)(function(){!function(e){try{var t=JSON.stringify(e);localStorage.setItem("go_state",t)}catch(a){}}({settings:te.getState().settings,dashboard:te.getState().dashboard,watchedRepos:te.getState().watchedRepos})}),1e3),Object(s.render)(o.a.createElement(K,{store:te}),document.getElementById("root"))}},[[34,2,1]]]);
//# sourceMappingURL=main.ad735882.chunk.js.map